parameters:
  service: ''
  environment: ''
  project: ''
  command: ''
  clusterName: ''

steps:

- template: keyvault-read.yaml
  parameters:
    serviceConnection: $(serviceConnection)
    environment: ${{ parameters.environment }}


- task: AzureCLI@1
  displayName: 'Bootstrap'
  inputs:
    azureSubscription: $(serviceConnection)
    addSpnToEnvironment: true
    scriptType: shell
    failOnStandardError: 'false'
    scriptPath: bootstrap/scripts/bootstrap.sh
    arguments: ${{ parameters.project }} aks $(env) $(controlKeyVault) $(serviceConnection) ${{ parameters.clusterName }} deploy '


